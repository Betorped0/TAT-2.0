@model TAT001.Entities.DOCUMENTO
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.pagina_r = 202;
    ViewBag.carpeta_r = 200;
    TAT001.Models.DocumentoFlujo _df = ViewBag.df as TAT001.Models.DocumentoFlujo;
    if (ViewBag.x_ligada == null) { ViewBag.x_ligada = false; }
    bool _ligada = ViewBag.x_ligada;//LEJ 23.07.2018
}
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.10.16/datatables.min.css" />
<script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.16/datatables.min.js"></script>
<script src="~/Scripts/edit.js"></script>
<script src="~/Scripts/formatos.js"></script>
<script src="~/Scripts/soporte.js"></script><!--RSG 23.05.2018-->
<script src="~/Scripts/recurrente.js"></script><!--RSG 27.05.2018-->
<script src="~/Scripts/analisis.js"></script><!--RSG 13.06.2018-->
<script src="~/Scripts/descargar.js"></script><!--RSG 22.06.2018-->
<script src="~/Scripts/ValidarNumero.js"></script>
@if (ViewBag.error != "")
{
    <script>
    $(document).ready(function () {
        function errorMessage(msg) {
            M.toast({ html: msg });
        }

        /**/
        var message = '@ViewBag.error';
    /**/

    if (message != "") {
        // do drop down loic
        errorMessage(message);
    }
});
    </script>
}
@* ------------------------------------------------------------------------LEJ 09-07-18 *@
<input id="miles" name="miles" type="hidden" value="@ViewBag.miles">
<input id="dec" name="dec" type="hidden" value="@ViewBag.dec">
<input id="mult" name="mult" type="hidden" value="@_df.D.DOCUMENTOF.Count">@*LEJ 03-08-18*@
<input id="horaServer" type="hidden" value="@ViewBag.horaServer">
<span class="span_fileload" style="display:none;"></span>
<span class="lbl_cabono" style="display:none;"></span>
<span class="lbl_ccargo" style="display:none;"></span>
<span class="lbl_cclear" style="display:none;"></span>
@* ------------------------------------------------------------------------LEJ 09-07-18 *@
<div class="row" style="margin-bottom:0">
    @{TAT001.Entities.USUARIO us = ViewBag.usuario;

        <div class="col s12 m5 l5">
            <div class="row" style="margin-bottom:0">
                <div class="input-field col s4">
                    @Html.EditorFor(model => model.USUARIOC_ID, "Usuario", new { htmlAttributes = new { @disabled = "disabled", @Value = us.ID } })
                    @Html.LabelFor(model => model.USUARIOC_ID, "Usuario", new { @id = "lbl_userid" })
                </div>
                @*<div class="input-field col s4">
                        @Html.EditorFor(model => model.USUARIO.MANAGER, new { htmlAttributes = new { @disabled = "disabled", @Value = us.MANAGER } })
                        @Html.LabelFor(model => model.USUARIO.MANAGER, "Manager", new { @id = "lbl_manager" })
                    </div>
                    <div class="input-field col s4">
                        @Html.EditorFor(model => model.USUARIO.BACKUP_ID, "BACKUP", new { htmlAttributes = new { @disabled = "disabled", @Value = us.BACKUP_ID } })
                        @Html.LabelFor(model => model.USUARIO.BACKUP_ID, "Backup", new { @id = "lbl_backup" })
                    </div>*@
            </div>
        </div>
        <div class="col s12 m4 l4">
            <div class="input-field col s3">
                @Html.EditorFor(model => model.USUARIO.BUNIT, "BU", new { htmlAttributes = new { @disabled = "disabled", @Value = us.BUNIT } })
                @Html.LabelFor(model => model.USUARIO.BUNIT, "BU", new { @id = "lbl_bu" })
            </div>
            <div class="input-field col s3">
                <input type="text" id="txt_status" value="Nuevo" disabled="disabled" />
                <label for="txt_status" id="lbl_status">Estatus</label>
            </div>
            @if (ViewBag.relacionadan != "" & Model.DOCUMENTO_REF != null)
            {
                <div class="input-field col s4">
                    <input type="text" id="txt_rel" name="txt_rel" value="@Model.DOCUMENTO_REF" disabled="disabled" />
                    @*<input type="text" id="txt_rel" name="txt_rel" value="@ViewBag.relacionadan" disabled="disabled" />*@
                    <label for="txt_rel" id="lbl_rel">Relacionada</label>
                </div>
            }
        </div>
    }
    <style>

        .div_left {
            float: left;
        }

        .div_right {
            float: right;
        }

        .div_bottom {
            clear: both;
        }

        .hr_bw {
            height: 4px;
            border: 0;
            margin-bottom: 0px;
            padding: 0;
            background-color: #ccc;
        }

        .hr_color {
            height: 6px;
            border: 0;
            margin: 0 0;
            padding: 0;
            background-color: #B90C46;
        }

        .hidden {
            display: none;
        }

        .tabs_menu {
            width: auto;
        }

        td.select_row {
            background: url('../images/playb.png') no-repeat center center;
            cursor: pointer;
        }

        tr.selected td.select_row {
            background: url('../images/play.png') no-repeat center center;
        }

        td.detail_row {
            background: url('../images/expandm.png') no-repeat center center;
            cursor: pointer;
        }

        tr.details td.detail_row {
            background: url('../images/expandl.png') no-repeat center center;
        }

        .errorMaterial {
            background-color: red;
        }

        .errorProveedor {
            background-color: red;
        }
    </style>
    <div class="div_right">
        <a href="@Url.Action("Index", "Home" )" class="btn btn-small">Cancelar</a>
        @if (Model.TSOL.REVERSO)
        {
            ViewBag.reversan = "X";
        }
        else
        {
            ViewBag.reversan = "";
        }
        @if (ViewBag.reversan != "X" | ViewBag.reversan == "X")
        {
            <a id="btn_guardarh" class="btn btn-small disabled">Guardar</a>
        }
    </div>
    <div class="div_bottom">
        <hr class="hr_bw" />
        <hr class="hr_color .pink.darken-1" />
    </div>
</div>
<div class="">
    <div class="row" style="background-color:#f4f4f4;">
        <div class="col s12">
            <ul class="tabs" id="tabs">
                <li class="tab col s2 tabs_menu"><a id="tab_info" href="#Informacion_cont" class="active">Información</a></li>
                @*<li class="tab col s2 tabs_menu"><a id="tab_temp" href="#Temporalidad_cont" disabled>Temporalidad</a></li>*@
                <li class="tab col s2 tabs_menu"><a id="tab_soporte" href="#Soporte_cont" disables>Soporte</a></li>
                <li class="tab col s3 tabs_menu"><a id="tab_dis" href="#Distribucion_cont">Distribución</a></li>
                <li id="tabs_rec" class="tab col s3 tabs_menu disabled"><a id="tab_rec" href="#Recurrente_cont">Recurrencia</a></li><!--RSG 09.07.2018-->
                <li class="tab col s2 tabs_menu"><a id="tab_fin" href="#Financiera_cont"><!--RSG 23.05.2018-->Financiera</a></li>
            </ul>
        </div>
    </div>
    @using (Html.BeginForm("Edit", "Solicitudes", FormMethod.Post, new { enctype = "multipart/form-data" }))
    {
        @Html.AntiForgeryToken()

        <div class="form-horizontal">
            @Html.ValidationSummary(true, "", new { @class = "text-danger" })
            @*Información*@
            @Html.HiddenFor(model => model.NUM_DOC)
            <div id="Informacion_cont" class="col s12" style="font-size:12px;">
                @*Tipo de solicitud*@
                <div class="row">
                    <div class="col s12 m6 l6">
                        @if (ViewBag.USUARIOC_ID != null)
                        {
                            <div class="card-panel">
                                <!--RSG 13.06.2018-->
                                <div class="row" style="margin-bottom:0;">
                                    <div class="input-field col s12">
                                        @Html.DropDownList("USUARIOC_ID", null, "")
                                        <label for="txt_rel" id="lbl_rel"></label>
                                    </div>
                                </div>
                            </div>
                        }
                        <div class="card-panel">
                            <h5>Tipo de solicitud y Clasificación</h5>
                            <div class="row" style="margin-bottom:0">
                                <div class="form-group col s12">
                                    @*@Html.LabelFor(model => model.TSOL_ID, "TSOL_ID", htmlAttributes: new { @class = "control-label col-md-2" })*@
                                    @Html.LabelFor(model => model.TSOL_ID, "Tipo de solicitud", htmlAttributes: new { @class = "control-label col-md-2" })
                                    <div class="col-md-10">
                                        @if (ViewBag.relacionada == "")
                                        {
                                            @Html.DropDownList("TSOL_ID", null, "", htmlAttributes: new { @id = "tsol_id", @class = "form-control", onchange = @"selectTsol(this.value);soportes(this.value, '" + Session["spras"].ToString() + "');" })
                                        }
                                        else
                                        {
                                            @*@Html.HiddenFor(model => model.TSOL_ID, new { @id = "tsol_id" })*@
                                            @Html.HiddenFor(model => model.TSOL_ID, new { @id = "tsol_id", onchange = @"selectTsol(this.value)" })@*@lej 24-07-2018*@

                                            <input type="text" value="@ViewBag.TSOL_IDI" disabled="disabled" />
                                            <input type="text" id="tsolant_id" value="@ViewBag.TSOL_ANT" disabled="disabled" hidden />
                                        }
                                    </div>
                                    @Html.HiddenFor(model => model.DOCUMENTO_REF)
                                    @{string jval = ViewBag.TSOL_VALUES;
                                        @Html.Hidden("TSOL_VALUES", jval)
                                    }
                                    @Html.HiddenFor(model => model.DOCUMENTO_REF)
                                    @{string jval2 = ViewBag.TSOL_VALUES2;
                                        @Html.Hidden("TSOL_VALUES2", jval2)
                                    }
                                </div>
                                @*<div class="form-group col s12">
                                        @Html.LabelFor(model => model.TALL_ID, "Clasificación", htmlAttributes: new { @class = "control-label col-md-2" })
                                        <div class="col-md-10">
                                            @if (ViewBag.relacionada == "")
                                            {
                                                @Html.DropDownList("GALL_ID", null, "", htmlAttributes: new { @id = "gall_id", @class = "form-control  " + @ViewBag.relacionada, onchange = @"selectTall(this.value)" })
                                            }
                                            else
                                            {
                                                <input type="hidden" value="@Model.GALL_ID" id="gall_id" />
                                                <input type="text" value="@ViewBag.GALL_IDI" disabled="disabled" />
                                                <input class="@ViewBag.relacionada" id="gall_idt" type="text" value="@ViewBag.GALL_IDI_VAL" disabled="disabled" style="display:none" />
                                            }
                                        </div>
                                    </div>*@
                                @*@Html.HiddenFor(model => model.TALL_ID, new { @id = "tall_id", @class = "form-control" })*@
                                <div class="form-group col s12">
                                    @Html.LabelFor(model => model.TALL_ID, "Clasificación", htmlAttributes: new { @class = "control-label col-md-2" })
                                    <div class="col-md-10">
                                        @if (ViewBag.relacionada == "")
                                        {
                                            @Html.DropDownList("TALL_ID", null, "", htmlAttributes: new { @id = "tall_id", @class = "form-control  " + @ViewBag.relacionada })
                                        }
                                        else
                                        {
                                            @*//MGC B20180611 se elimina clasificación*@
                                            <input type="hidden" value="@Model.TALL_ID" id="tall_id" /><!--RSG 23.05.2018-->
                                            <input type="text" value="@ViewBag.TALL_IDI" disabled="disabled" />
                                            @*<input type="text" value="@ViewBag.TALL_IDI" disabled="disabled" />
                                                <input class="@ViewBag.relacionada" id="gall_idt" type="text" value="@ViewBag.GALL_IDI_VAL" disabled="disabled" style="display:none" />
                                            *@
                                        }
                                    </div>
                                </div>
                            </div>
                        </div>
                        @*Datos del país*@
                        <div class="card-panel">
                            <h5>Datos del país</h5>
                            <div class="row" style="margin-bottom:0">
                                <div class="col s6">
                                    <div class="form-group">
                                        @Html.LabelFor(model => model.SOCIEDAD_ID, "Sociedad", htmlAttributes: new { @class = "control-label col-md-2" })
                                        <div class="col-md-10">
                                            @Html.EditorFor(model => model.SOCIEDAD_ID, new { htmlAttributes = new { @id = "sociedad_id", @class = "form-control", @disabled = "disabled" } })
                                        </div>
                                    </div>
                                </div>
                                @{TAT001.Entities.PAI pais = ViewBag.PAIS_ID;
                                    <div class="col s6">
                                        <div class="form-group hidden">
                                            @Html.LabelFor(model => model.PAIS_ID, "Subregión", htmlAttributes: new { @class = "control-label col-md-2 hidden" })
                                            <div class="col-md-10">
                                                @Html.EditorFor(model => model.PAIS_ID, new { htmlAttributes = new { @id = "pais_id", @class = "form-control hidden", @disabled = "disabled", @Value = pais.LAND } })
                                            </div>
                                        </div>
                                        <div class="input-field col-md-2">
                                            <input value="@pais.LANDX" id="pais_txt" type="text" class="" disabled="disabled" />
                                            <label for="pais_txt">Subregión</label>
                                        </div>
                                    </div>
                                }
                                <div>
                                    <div class="input-field col s6">
                                        @Html.EditorFor(model => model.SOCIEDAD.REGION, new { htmlAttributes = new { @id = "region_id", @disabled = "disabled" } })
                                        @Html.LabelFor(model => model.SOCIEDAD.REGION, "Región", htmlAttributes: new { @for = "region_id" })
                                    </div>
                                </div>
                                <div class="input-field col s12">
                                    @if (!Model.TSOL.REVERSO & Model.DOCUMENTO_REF == null)
                                    {
                                        @Html.EditorFor(model => model.ESTADO, new { htmlAttributes = new { @id = "state_id", @class = "form-control " } })
                                    }
                                    else
                                    {
                                        @Html.EditorFor(model => model.ESTADO, new { htmlAttributes = new { @id = "state_id", @class = "form-control ", @disabled = "disabled" } })
                                    }
                                    @Html.LabelFor(model => model.ESTADO, "Estado", htmlAttributes: new { @for = "state_id" })
                                </div>
                                <link href="~/Content/autocomplete.css" rel="stylesheet" />
                                <script src="~/Scripts/autocomplete1.10.2.js"></script>
                                <script src="~/Scripts/autocomplete1.11.4.js"></script>
                                <script>
                            var auto = $.noConflict(true);
                            auto(document).ready(function () {
                                var pais = '@ViewBag.pais';
                            auto("#state_id").autocomplete({
                                source: function (request, response) {
                                    auto.ajax({
                                        url: "../Listas/Estados",
                                        type: "GET",
                                        dataType: "json",
                                        data: { pais: pais, Prefix: request.term },
                                        success: function (data) {
                                            response($.map(data, function (item) {
                                                return { label: item.NAME, value: item.NAME };
                                            }))
                                        }
                                    })
                                },
                                messages: {
                                    noResults: '',
                                    results: function (resultsCount) { }
                                },
                                change: function (e, ui) {
                                    if (!(ui.item)) {
                                    }
                                }
                            });
                        })
                                </script>
                                <script src="~/Scripts/createa.js"></script>
                                <div class="input-field col s12">
                                    @if (!Model.TSOL.REVERSO & Model.DOCUMENTO_REF == null)
                                    {
                                        @Html.EditorFor(model => model.CIUDAD, new { htmlAttributes = new { @id = "city_id", @class = "form-control " } })
                                    }
                                    else
                                    {
                                        @Html.EditorFor(model => model.CIUDAD, new { htmlAttributes = new { @id = "city_id", @class = "form-control ", @disabled = "disabled" } })
                                    }
                                    @Html.LabelFor(model => model.CIUDAD, "Ciudad", htmlAttributes: new { @for = "city_id" })
                                </div>
                                <script>
                                                                        auto(document).ready(function () {
                                                                            auto("#city_id").autocomplete({
                                                                                source: function (request, response) {
                                                                                    var estado = $("#state_id").val();
                                                                                    auto.ajax({
                                                                                        url: "../Listas/Ciudades",
                                                                                        type: "GET",
                                                                                        dataType: "json",
                                                                                        data: { estado: estado, Prefix: request.term },
                                                                                        success: function (data) {
                                                                                            response(auto.map(data, function (item) {
                                                                                                return { label: item.NAME, value: item.NAME };
                                                                                            }))
                                                                                        }
                                                                                    })
                                                                                },
                                                                                messages: {
                                                                                    noResults: '',
                                                                                    results: function (resultsCount) { }
                                                                                },
                                                                                change: function (e, ui) {
                                                                                    if (!(ui.item)) {

                                                                                    }
                                                                                }
                                                                            });
                                                                        })
                                </script>
                            </div>
                        </div>
                        @*Información General*@
                        <div class="card-panel">
                            <h5>Información General</h5>
                            <div class="row" style="margin-bottom:0">
                                <div class="input-field col s12">
                                    <i class="material-icons prefix">date_range</i>
                                    @Html.HiddenFor(model => model.FECHAD, new { htmlAttributes = new { @class = "form-control datepicker", onkeyup = "borrar(this);" } })
                                    <input value="@ViewBag.FECHAD" id="fechad" type="text" class="" disabled="disabled" />
                                    <label for="fechad">Fecha</label>
                                </div>
                                <div class="input-field col s6">
                                    @Html.HiddenFor(model => model.PERIODO, new { htmlAttributes = new { @class = "form-control" } })
                                    <input value="@ViewBag.PERIODO" id="periodo" type="text" class="" disabled="disabled" />
                                    <label for="periodo">Periodo</label>
                                </div>
                                <script>
                                                                        var elemdp = document.querySelector('#fechad');
                                                                        var optionsdp = {
                                                                            format: 'dd/mm/yyyy',
                                                                            onClose: function (e) {
                                                                                var date = $('#fechad').val();
                                                                                var periodo = date.split("/");

                                                                                $('#periodo').val(periodo[1]);
                                                                            },
                                                                            i18n: {
                                                                                clear: 'Limpiar',
                                                                                today: 'Hoy',
                                                                                done: 'Seleccionar',
                                                                                previousMonth: '‹',
                                                                                nextMonth: '›',
                                                                                months: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
                                                                                monthsShort: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'],
                                                                                weekdaysShort: ['Dom', 'Lun', 'Mar', 'Mie', 'Jue', 'Vie', 'Sab'],
                                                                                weekdays: ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado'],
                                                                                weekdaysAbbrev: ['D', 'L', 'M', 'X', 'J', 'V', 'S']
                                                                            }
                                                                        };
                                                                        var instancedp = M.Datepicker.init(elemdp, optionsdp);

                                </script>
                                <div class="input-field col s6">
                                    @Html.HiddenFor(model => model.EJERCICIO, new { htmlAttributes = new { @class = "form-control" } })
                                    <input value="@ViewBag.EJERCICIO" id="ejercicio" type="text" class="" disabled="disabled" />
                                    <label for="ejercicio">Ejercicio</label>
                                </div>
                                <div class="input-field col s12">
                                    @if (!Model.TSOL.REVERSO & Model.DOCUMENTO_REF == null)
                                    {
                                        @Html.EditorFor(model => model.CONCEPTO, new { htmlAttributes = new { @id = "concepto", @class = "form-control " } })
                                    }
                                    else
                                    {
                                        @Html.EditorFor(model => model.CONCEPTO, new { htmlAttributes = new { @id = "concepto", @class = "form-control ", @disabled = "disabled" } })
                                    }
                                    <label for="concepto">Concepto*</label>
                                </div>
                                <div class="input-field col s12">
                                    @if (!Model.TSOL.REVERSO & Model.DOCUMENTO_REF == null)
                                    {
                                        @Html.TextAreaFor(model => model.NOTAS, new { @class = "materialize-textarea ", @id = "notas_txt", onkeyup = "maxchar();" })
                                    }
                                    else
                                    {
                                        @Html.TextAreaFor(model => model.NOTAS, new { @class = "materialize-textarea ", @id = "notas_txt", onkeyup = "maxchar();", @disabled = "disabled" })
                                    }
                                    @Html.LabelFor(model => model.NOTAS, "Mecánica de negociación", htmlAttributes: new { @class = "active", @for = "notas_txt" })
                                </div>
                                <script>
                                                                        function maxchar(w) {
                                                                            var maxLength = 255;
                                                                            var text = $('#notas_txt').val();
                                                                            var textLength = text.length;
                                                                            if (textLength > (maxLength)) {
                                                                                $('#notas_txt').val(text.substring(0, ((maxLength))));
                                                                                var msg = 'Número máximo para la negociación es ' + maxLength;
                                                                                M.toast({ html: msg });
                                                                            }
                                                                        }
                                </script>
                            </div>
                        </div>
                    </div>
                    <div class="col s12 m6 l6">
                        @*Información Cliente*@
                        <div class="card-panel">
                            <h5>Información del cliente</h5>
                            <div class="row" style="margin-bottom:0">
                                <div class="input-field col s12">
                                    @Html.EditorFor(model => model.PAYER_ID, new { htmlAttributes = new { @id = "payer_id", @disabled = "disabled ", @onchange = @"selectCliente(this.value)" } })
                                    @Html.LabelFor(model => model.PAYER_ID, "Cliente", htmlAttributes: new { @for = "payer_id" })
                                </div>
                                <script>
                                                                        auto(document).ready(function () {
                                                                            auto("#payer_id").autocomplete({
                                                                                source: function (request, response) {
                                                                                    auto.ajax({
                                                                                        url: "../Listas/Clientes",
                                                                                        type: "GET",
                                                                                        dataType: "json",
                                                                                        data: { Prefix: request.term },
                                                                                        success: function (data) {
                                                                                            response(auto.map(data, function (item) {
                                                                                                return { label: item.KUNNR + " - " + item.NAME1, value: item.KUNNR };
                                                                                            }))
                                                                                        }
                                                                                    })
                                                                                },
                                                                                messages: {
                                                                                    noResults: '',
                                                                                    results: function (resultsCount) { }
                                                                                },
                                                                                change: function (e, ui) {
                                                                                    if (!(ui.item)) {
                                                                                        e.target.value = "";
                                                                                    }
                                                                                },

                                                                                select: function (event, ui) {

                                                                                    var label = ui.item.label;
                                                                                    var value = ui.item.value;
                                                                                    selectCliente(value);
                                                                                }
                                                                            });
                                                                        })
                                </script>
                                <input type="hidden" id="txt_vkorg" />
                                <input type="hidden" id="txt_vtweg" />
                                <input type="hidden" id="txt_spras" value="@Session["spras"].ToString()" />
                                <div class="input-field col s12">
                                    <input type="text" id="cli_name" value="@ViewBag.NAME1" disabled="disabled" />
                                    <label for="cli_name">Nombre</label>
                                </div>
                                <div class="input-field  col s12">
                                    <input value="@ViewBag.PARVW" id="parvw" type="text" class="" disabled="disabled" />
                                    <label for="parvw">Tipo de cliente</label>
                                </div>
                                <div class="input-field col s12">
                                    @Html.LabelFor(model => model.VKORG, "Razón Social", htmlAttributes: new { @class = "control-label col-md-2", @for = "vkorg" })
                                    <div class="col-md-10">
                                        @Html.EditorFor(model => model.VKORG, new { htmlAttributes = new { @disabled = "disabled", @id = "vkorg", @class = "form-control" } })
                                    </div>
                                </div>
                                <div class="input-field  col s12">
                                    <input value="@ViewBag.STCD1" id="stcd1" type="text" class="" disabled="disabled" />
                                    <label for="stcd1">Tax ID</label>
                                </div>
                                <div class="input-field col s12">
                                    @Html.LabelFor(model => model.VTWEG, "Canal", htmlAttributes: new { @class = "control-label col-md-2", @for = "vtweg" })
                                    <div class="col-md-10">
                                        @Html.EditorFor(model => model.VTWEG, new { htmlAttributes = new { @disabled = "disabled", @id = "vtweg", @class = "form-control" } })
                                    </div>
                                </div>
                                <div class="input-field col s12">
                                    @if (!Model.TSOL.REVERSO)
                                    {
                                        @Html.EditorFor(model => model.PAYER_NOMBRE, new { htmlAttributes = new { @id = "payer_nombre", @class = "form-control " } })
                                    }
                                    else
                                    {
                                        @Html.EditorFor(model => model.PAYER_NOMBRE, new { htmlAttributes = new { @id = "payer_nombre", @class = "form-control ", @disabled = "disabled" } })
                                    }
                                    @Html.LabelFor(model => model.PAYER_NOMBRE, "Nombre del contacto", htmlAttributes: new { @class = "control-label col-md-2", @for = "payer_nombre" })
                                </div>
                                <div class="input-field col s12">
                                    @if (!Model.TSOL.REVERSO)
                                    {
                                        @Html.EditorFor(model => model.PAYER_EMAIL, new { htmlAttributes = new { @id = "payer_email", @class = " ", @type = "email" } })}
                                    else
                                    {
                                        @Html.EditorFor(model => model.PAYER_EMAIL, new { htmlAttributes = new { @id = "payer_email", @class = " ", @type = "email", @disabled = "disabled" } })
                                    }
                                    @Html.LabelFor(model => model.PAYER_EMAIL, "Email de contacto", htmlAttributes: new { @class = "control-label col-md-2", @for = "payer_email" })
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col s12 m6 l6">
                        <div class="card-panel">
                            <h5>Vigencia</h5>
                            <div class="row" style="margin-bottom:0">
                                <!--RSG 22.05.2018-->
                                @if (!Model.TSOL.REVERSO & Model.DOCUMENTO_REF == null)
                                {
                                    <div class="col s12">
                                        <label class="col s6">
                                            <input name="group1" type="radio" id="btn-date" onclick="cambiaTemp(this.id)" />
                                            <span>Por fecha</span>
                                        </label>
                                        <label class="col s6">
                                            <input name="group1" type="radio" checked id="btn-peri" onclick="cambiaTemp(this.id)" />
                                            <span>Por periodo</span>
                                        </label>
                                    </div>
                                    <script>
                                                                                function cambiaTemp(id) {
                                                                                    var tipo = id.split('-')[1];
                                                                                    if (tipo == "date") {
                                                                                        document.getElementById("periodoi_id").setAttribute("disabled", "disabled");
                                                                                        document.getElementById("anioi_id").setAttribute("disabled", "disabled");
                                                                                        document.getElementById("periodof_id").setAttribute("disabled", "disabled");
                                                                                        document.getElementById("aniof_id").setAttribute("disabled", "disabled");

                                                                                        document.getElementById("fechai_vig2").removeAttribute("disabled");
                                                                                        document.getElementById("fechaf_vig2").removeAttribute("disabled");
                                                                                    } else {
                                                                                        document.getElementById("periodoi_id").removeAttribute("disabled");
                                                                                        document.getElementById("anioi_id").removeAttribute("disabled");
                                                                                        document.getElementById("periodof_id").removeAttribute("disabled");
                                                                                        document.getElementById("aniof_id").removeAttribute("disabled");

                                                                                        document.getElementById("fechai_vig2").setAttribute("disabled", "disabled");
                                                                                        document.getElementById("fechaf_vig2").setAttribute("disabled", "disabled");

                                                                                    }
                                                                                    setDates(tipo);
                                                                                    var elem = document.querySelectorAll('select');
                                                                                    var instance = M.FormSelect.init(elem, []);
                                                                                    pickerFecha2(".format_date");
                                                                                }
                                    </script>
                                    <div class="col s6">
                                        <div class="input-field col s12">
                                            <i class="material-icons prefix">date_range</i>
                                            @*@Html.EditorFor(model => model.FECHAI_VIG, new { htmlAttributes = new { @id = "fechai_vig", @class = "form-control datepicker " + @ViewBag.relacionada, @onkeyup = "borrar(this);" } })*@
                                            @Html.HiddenFor(model => model.FECHAI_VIG, new { @id = "fechai_vig", @class = "form-control datepicker " })
                                            <input type="text" disabled class="datepicker" id="fechai_vig2" onkeyup="borrar(this);" onchange="document.getElementById('fechai_vig').value = this.value" />
                                            @Html.LabelFor(model => model.FECHAI_VIG, "De", htmlAttributes: new { @class = "active", @for = "fechai_vig2" })
                                        </div>
                                        <div class="input-field col s12">
                                            <i class="material-icons prefix">date_range</i>
                                            @*@Html.EditorFor(model => model.FECHAF_VIG, new { htmlAttributes = new { @id = "fechaf_vig", @class = "form-control datepicker " + @ViewBag.relacionada, onkeyup = "borrar(this);" } })*@
                                            @Html.HiddenFor(model => model.FECHAF_VIG, new { @id = "fechaf_vig", @class = "form-control datepicker " })
                                            <input type="text" disabled class="datepicker" id="fechaf_vig2" onkeyup="borrar(this);" onchange="document.getElementById('fechaf_vig').value = this.value" />
                                            @Html.LabelFor(model => model.FECHAF_VIG, "Hasta", htmlAttributes: new { @class = "active", @for = "fechaf_vig2" })
                                        </div>
                                    </div>
                                    <script>
                                                                                asignaFechasInit();
                                                                                function asignaFechasInit() {
                                                                                    var datei = document.getElementById("fechai_vig").value.split(" ")[0];
                                                                                    var datef = document.getElementById("fechaf_vig").value.split(" ")[0];
                                                                                    //var datei = document.getElementById("fechai_vig").value;
                                                                                    //var datef = document.getElementById("fechaf_vig").value;

                                                                                    if (datei != "") {
                                                                                        document.getElementById("fechai_vig2").value = datei;
                                                                                    }
                                                                                    if (datef != "") {
                                                                                        document.getElementById("fechaf_vig2").value = datef;
                                                                                    }
                                                                                }
                                    </script>
                                    <div class="col s6">
                                        <div class="col s12">
                                            <div class="input-field col s6">
                                                @Html.DropDownList("PERIODOS", null, "", htmlAttributes: new { @id = "periodoi_id", @onchange = "setDates('')" })
                                                <label>De</label>
                                            </div>
                                            <div class="input-field col s3">
                                                @Html.DropDownList("ANIOS", null, "", htmlAttributes: new { @id = "anioi_id", @onchange = "setDates('')" })
                                            </div>
                                        </div><div class="col s12">
                                            <div class="input-field col s6">
                                                @Html.DropDownList("PERIODOS", null, "", htmlAttributes: new { @id = "periodof_id", @onchange = "setDates('')" })
                                                <label>Hasta</label>
                                            </div>
                                            <div class="input-field col s3">
                                                @Html.DropDownList("ANIOS", null, "", htmlAttributes: new { @id = "aniof_id", @onchange = "setDates('')" })
                                            </div>
                                        </div>
                                    </div>
                                    <script>
                                                                                var datei = document.getElementById("fechai_vig").value;
                                                                                var datef = document.getElementById("fechaf_vig").value;
                                                                                var elemth = document.querySelector('#fechai_vig2');
                                                                                var optionsth = {
                                                                                    defaultDate: new Date(datei.split('/')[2], datei.split('/')[1] - 1, datei.split('/')[0]),
                                                                                    format: 'dd/mm/yyyy',
                                                                                    i18n: {
                                                                                        clear: 'Limpiar',
                                                                                        today: 'Hoy',
                                                                                        done: 'Seleccionar',
                                                                                        previousMonth: '‹',
                                                                                        nextMonth: '›',
                                                                                        months: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
                                                                                        monthsShort: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'],
                                                                                        weekdaysShort: ['Dom', 'Lun', 'Mar', 'Mie', 'Jue', 'Vie', 'Sab'],
                                                                                        weekdays: ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado'],
                                                                                        weekdaysAbbrev: ['D', 'L', 'M', 'X', 'J', 'V', 'S']
                                                                                    }
                                                                                };
                                                                                var instanceth = M.Datepicker.init(elemth, optionsth);

                                                                                var elemtd = document.querySelector('#fechaf_vig2');
                                                                                var optionstd = {
                                                                                    defaultDate: new Date(datef.split('/')[2], datef.split('/')[1] - 1, datef.split('/')[0]),
                                                                                    format: 'dd/mm/yyyy',
                                                                                    onClose: function (e) {
                                                                                        var datei = $('#fechai_vig2').val();
                                                                                        var datef = $('#fechaf_vig2').val();
                                                                                        var res = validar_fechas(datei, datef);

                                                                                        if (!res) {
                                                                                            $('#fechaf_vig2').val("");
                                                                                            M.toast({ html: 'Las fechas no tienen un secuencia correcta' });
                                                                                        }
                                                                                    },
                                                                                    i18n: {
                                                                                        clear: 'Limpiar',
                                                                                        today: 'Hoy',
                                                                                        done: 'Seleccionar',
                                                                                        previousMonth: '‹',
                                                                                        nextMonth: '›',
                                                                                        months: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
                                                                                        monthsShort: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'],
                                                                                        weekdaysShort: ['Dom', 'Lun', 'Mar', 'Mie', 'Jue', 'Vie', 'Sab'],
                                                                                        weekdays: ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado'],
                                                                                        weekdaysAbbrev: ['D', 'L', 'M', 'X', 'J', 'V', 'S']
                                                                                    }
                                                                                };
                                                                                var instancetd = M.Datepicker.init(elemtd, optionstd);

                                                                                function borrar(field) {
                                                                                    field.value = "";
                                                                                }
                                                                                //LEJ 30.07.2018
                                                                                _ff();
                                    </script>
                                }
                                else
                                { <div class="col s12">
                                        <div class="input-field col s6">
                                            <i class="material-icons prefix">date_range</i>
                                            @Html.EditorFor(model => model.FECHAI_VIG, new { htmlAttributes = new { @id = "fechai_vig", @class = "form-control datepicker " + @ViewBag.relacionada, @onkeyup = "borrar(this);" } })
                                            @Html.LabelFor(model => model.FECHAI_VIG, "De", htmlAttributes: new { @class = "active", @for = "fechai_vig2" })
                                        </div>
                                        <div class="input-field col s6">
                                            <i class="material-icons prefix">date_range</i>
                                            @Html.EditorFor(model => model.FECHAF_VIG, new { htmlAttributes = new { @id = "fechaf_vig", @class = "form-control datepicker " + @ViewBag.relacionada, onkeyup = "borrar(this);" } })
                                            @Html.LabelFor(model => model.FECHAF_VIG, "Hasta", htmlAttributes: new { @class = "active", @for = "fechaf_vig2" })
                                        </div>
                                    </div>
                                    <input name="group1" type="hidden" id="btn-peri" />
                                }
                            </div>
                        </div>
                        <div id="div_picker2"></div><!--RSG 27.05.2017-->
                    </div>
                    <div id="ref_soporte" style="display:table" class="col s12">
                        @*LEJ 26.07.18----I*@
                        <div class="card-panel">
                            <h5>Referencia de Facturas</h5>
                            <div class="row" style="margin-bottom:0;">
                                <p>
                                    <label>
                                        <input id="check_facturas" name="unafact" type="hidden" value="@ViewBag.UNAFACTURA" />
                                        <input id="check_factura" type="checkbox" checked="checked" disabled />
                                        <span>Multiples Facturas</span>
                                    </label>
                                </p>
                                @*Cargar archivo excel soporte*@
                                <div id="file_facturat" class="file-field input-field" style="display:none">
                                    <div class="btn">
                                        <span>File</span>
                                        <input type="file" class="file_sop" id="file_sop">
                                    </div>
                                    <div class="file-path-wrapper">
                                        <input class="file-path  file_sop" type="text">
                                    </div>
                                </div>
                                <div class="table_sop" id="" style="display:none">
                                </div>
                                @if (_df.D.DOCUMENTOF != null)//LEJ 24.07.18
                                {
                                    if (_df.D.DOCUMENTOF.Count > 0)//LEJ 24.07.18
                                    {
                                        <table class="table_sop display" id="table_sop" cellspacing="0" style="width:100%;display:none">
                                            <thead>
                                                <tr>
                                                    <th>Pos</th>
                                                    <th>Sociedad</th>
                                                    <th>Factura</th>
                                                    <th>Fecha Factura</th>
                                                    <th>Bill Doc</th>
                                                    <th>Proveedor</th>
                                                    <th>Proveedor Desc</th>
                                                    <th>Control</th>
                                                    <th>Autorización</th>
                                                    <th>Vencimiento</th>
                                                    <th>Factura k</th>
                                                    <th>Ejercicio k</th>
                                                    <th>Payer</th>@*@18-07-2018 jemo *@
                                                    <th>Descripcion</th>@*@18-07-2018 jemo *@
                                                    <th>Importe Factura</th>@*@18-07-2018 jemo *@
                                                    <th>Belnr</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>
                                        </table>
                                        @*<a class="waves-light btn-small" id="sendTable"><i class="material-icons left">add</i>Send table to html</a>*@
                                        <table id="table_soph" class="display" cellspacing="0" style="display:none">
                                            <tbody>
                                                @for (var i = 0; i < _df.D.DOCUMENTOF.Count; i++)
                                                {
                                                    <tr>
                                                        <td>
                                                            @_df.D.DOCUMENTOF[i].POS
                                                        </td>
                                                        <td>
                                                            @_df.D.DOCUMENTOF[i].SOCIEDAD
                                                        </td>
                                                        <td>
                                                            @_df.D.DOCUMENTOF[i].FACTURA
                                                        </td>
                                                        <td>
                                                            @_df.D.DOCUMENTOF[i].FECHA
                                                        </td>
                                                        <td>
                                                            @_df.D.DOCUMENTOF[i].BILL_DOC
                                                        </td>
                                                        <td>
                                                            @_df.D.DOCUMENTOF[i].PROVEEDOR
                                                        </td>
                                                        <td>
                                                            @_df.D.DOCUMENTOF[i].CONTROL
                                                        </td>
                                                        <td>
                                                            @_df.D.DOCUMENTOF[i].AUTORIZACION
                                                        </td>
                                                        <td>
                                                            @_df.D.DOCUMENTOF[i].VENCIMIENTO
                                                        </td>
                                                        <td>
                                                            @_df.D.DOCUMENTOF[i].FACTURAK
                                                        </td>
                                                        <td>
                                                            @_df.D.DOCUMENTOF[i].EJERCICIOK
                                                        </td>
                                                        <td>
                                                            @_df.D.DOCUMENTOF[i].PAYER
                                                        </td>
                                                        <td>
                                                            @_df.D.DOCUMENTOF[i].DESCRIPCION@*//B20180625 JEMO 2018.06.27*@
                                                        </td>
                                                        <td>
                                                            @_df.D.DOCUMENTOF[i].IMPORTE_FAC
                                                        </td>
                                                        <td>
                                                            @_df.D.DOCUMENTOF[i].BELNR
                                                        </td>
                                                    </tr>
                                                }
                                            </tbody>
                                        </table>
                                    }
                                }
                            </div>
                        </div>
                    </div>@*LEJ 26.07.18----T*@
                </div>
            </div>
            @*Recurrencia*@
            <div id="Recurrente_cont" class="row" style="font-size:12px;">
                <div class="col s12 l8 offset-l2">
                    <div class="card horizontal green white-text">
                        <div class="col s12" style="margin-bottom0;">
                            <p>
                                Esta pestaña se debe llenar solamente si necesitas que tu solicitud se genere automáticamente durante los periodos seleccionados
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col s12">
                    <div class="card-panel">
                        <h5>Recurrente</h5>
                        <input type="hidden" id="txt_trec" />
                        <div class="row" style="margin-bottom:0;">
                            <p>
                                <input type="hidden" value="@Model.DOCUMENTOREC.Count" id="valRec" />@*LEJ 31.07.2018---------------------*@
                                <label>
                                    @*<input id="check_reccurrentes" name="unarect" type="hidden" value="@ViewBag.RECURR" />*@
                                    <input id="check_recurrente" type="checkbox" onchange="cambiaRec(this)" />
                                    <span>Documento recurrente</span>
                                </label>
                            </p>
                            <table class="table_rec display" id="table_rec" cellspacing="0" style="width:100%;display:none">
                                <thead>
                                    <tr>
                                        <th id=""></th>@*B20180801 MGC Textos*@
                                        <th id="thead_rnumero">NO</th>@*B20180801 MGC Textos*@
                                        <th id="thead_rperiodo">Periodo</th>@*B20180801 MGC Textos*@
                                        <th id="thead_rtiposol">Solicitud</th>@*B20180801 MGC Textos*@
                                        <th id="thead_rfecha">FECHA</th>@*B20180801 MGC Textos*@
                                        <th id="thead_rmonto">Monto</th>@*B20180801 MGC Textos*@
                                        <th id="thead_rporc">Porcentaje</th>@*B20180801 MGC Textos*@
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                            @*<a class="waves-light btn-small" id="sendTableR" onclick="enviaRec()"><i class="material-icons left">add</i>Enviar</a>*@
                            <table id="table_rech" class="display" cellspacing="0" style="display:none">
                                <thead>
                                    <tr>
                                        <th>NO</th>
                                        <th>TSOL</th>
                                        <th>FECHA</th>
                                        <th>Monto</th>
                                        <th>Porcentaje</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @if (Model.DOCUMENTOREC != null)
                                    {
                                        for (var i = 0; i < Model.DOCUMENTOREC.Count; i++)
                                        {
                                            <tr>
                                                <td>
                                                    @Model.DOCUMENTOREC[i].NUM_DOC
                                                </td>
                                                <td>
                                                    @Model.DOCUMENTOREC[i].POS
                                                </td>
                                                <td>
                                                    @Model.DOCUMENTOREC[i].FECHAF
                                                </td>
                                                <td>
                                                    @Model.DOCUMENTOREC[i].MONTO_BASE
                                                </td>
                                                <td>
                                                    @Model.DOCUMENTOREC[i].PORC
                                                </td>
                                                <td>
                                                    @Model.DOCUMENTOREC[i].DOC_REF
                                                </td>
                                                <td>
                                                    @Model.DOCUMENTOREC[i].EJERCICIO
                                                </td>
                                                <td>
                                                    @Model.DOCUMENTOREC[i].ESTATUS
                                                </td>
                                                <td>
                                                    @Model.DOCUMENTOREC[i].MONTO_FIJO
                                                </td>
                                                <td>
                                                    @Model.DOCUMENTOREC[i].MONTO_GRS
                                                </td>
                                                <td>
                                                    @Model.DOCUMENTOREC[i].MONTO_NET
                                                </td>
                                                <td>
                                                    @Model.DOCUMENTOREC[i].PERIODO
                                                </td>
                                            </tr>
                                        }
                                    }
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="col s12">
                    @*LEJ 31.07.2018*@
                    <div id="div_objq" class="card-panel hide">
                        <input type="hidden" id="txt_trec" />
                        <div class="row" style="margin-bottom:0;">
                            <p>
                                <label>
                                    @*<input id="check_reccurrentes" name="unarect" type="hidden" value="@ViewBag.RECURR" />*@
                                    <input id="check_objetivoq" name="check_objetivoq" type="checkbox" onchange="objetivoQ(this.checked);" />
                                    <span id="span_objq">Objetivo Q</span> @*B20180801 MGC Textos*@
                                </label>
                                <script>
                                                                        function objetivoQ(ban) {
                                                                            if (ban) {
                                                                                var lengthT = $("table#table_rec tbody tr[role='row']").length;
                                                                                if (lengthT > 0) {
                                                                                    document.getElementById('table_objQ').classList.remove("hide");
                                                                                    var total = 0;
                                                                                    var porc = 0;
                                                                                    var fecha = "";
                                                                                    var tsol = "";
                                                                                    $("#table_rec > tbody  > tr[role='row']").each(function () {
                                                                                        total += parseFloat(toNum($(this).find("td.MONTO input").val()));
                                                                                        //porc = toNum($(this).find("td.PORCENTAJE").text());
                                                                                        fecha = ($(this).find("td.FECHA").text());
                                                                                        tsol = $(this).find("td.TSOL").text();
                                                                                    });
                                                                                    document.getElementById("obqTSOL").innerText = tsol;
                                                                                    document.getElementById("obqFECHA").innerText = fecha;
                                                                                    document.getElementById("obqMONTO").innerText = toShow(total);
                                                                                    //document.getElementById("obqPORC").innerText = toShowPorc(porc);
                                                                                }
                                                                            }
                                                                            else {
                                                                                document.getElementById('table_objQ').classList.add("hide");
                                                                            }
                                                                        }
                                                                        function updateObjQ() {
                                                                            var lengthT = $("table#table_rec tbody tr[role='row']").length;
                                                                            if (lengthT > 0) {
                                                                                var total = 0;
                                                                                $("#table_rec > tbody  > tr[role='row']").each(function () {
                                                                                    total += parseFloat(toNum($(this).find("td.MONTO input").val()));
                                                                                });
                                                                                document.getElementById("obqMONTO").innerText = toShow(total);
                                                                            }

                                                                        }
                                </script>
                                @if (Model.OBJETIVOQ == true)
                                {
                                    <script>
                                                                                document.getElementById("check_objetivoq").checked = true;

                                    </script>
                                }
                            </p>
                            <div style="overflow:auto;">
                                <table id="table_objQ" class="display hide" cellspacing="0" style="font-size:12px;">
                                    <thead>
                                        <tr>
                                            <th>NO</th>
                                            <th>TSOL</th>
                                            <th>FECHA</th>
                                            <th>Monto</th>
                                            <th>Porcentaje</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Q</td>
                                            <td id="obqTSOL"></td>
                                            <td id="obqFECHA"></td>
                                            <td id="obqMONTO"></td>
                                            @*<td><input type="text" id="objPORC" style="width:150px;font-size:12px;height:2rem;" name="objPORC" onchange="this.value = toShowPorc(this.value);" class="input_dcp"/></td>*@
                                            <td>
                                                @Html.EditorFor(model => model.OBJQ_PORC, new { htmlAttributes = new { @id = "objPORC", @class = "input_dcp ", @style = "width:150px;font-size:12px;height:2rem;", @onchange = "this.value = toShowPorc(this.value);" } })
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <p>
                                <div class="input-field col l4 m4 s12">
                                    <select id="sel_nn" name="sel_nn">
                                        <option id="opt_mmes" value="1">Mensual</option> @*B20180801 MGC Textos*@
                                        <option id="opt_tmes" value="3">Trimestral</option> @*B20180801 MGC Textos*@
                                        <option id="opt_smes" value="6">Semestral</option> @*B20180801 MGC Textos*@
                                        <option id="opt_ames" value="12">Anual</option> @*B20180801 MGC Textos*@
                                    </select>
                                    <label id="lbl_selnn" for="sel_nn">Frecuencia de liquidación / Orden de pago</label> @*B20180801 MGC Textos*@
                                </div>
                            </p>
                        </div>
                    </div>
                </div>
                @*LEJ 31.07.2018*@
            </div>
            @*Soporte*@
            <div id="Soporte_cont">
                <div class="row">
                    <div class="col s12 m6 l6">
                        @if (ViewBag.reversan != "X" & ViewBag.reversan == "X")
                        {

                            <div class="card-panel">
                                <h5>Documentos de Soporte2</h5>
                                <label>* Campos obligatorios</label>
                                <div class="row" style="margin-bottom:0">
                                    <div class="col s12">
                                        <form action="#">
                                            <div class="row" id="div_soportes">
                                            </div>
                                            <!--RSG 23.05.2018-->
                                            <script>
                                    /**/
                                    soportes(document.getElementById("tsol_id").value, '@Session["spras"].ToString()');
                                    /**/
                                            </script>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        }
                        <input type="hidden" id="txt_sop_borr" name="txt_sop_borr" />
                        @if (!Model.TSOL.REVERSO)
                        {
                            List<TAT001.Entities.DOCUMENTOA> archivo = ViewBag.files as List<TAT001.Entities.DOCUMENTOA>;
                            if (ViewBag.relacionadan != "" && archivo.Count >= 0)
                            {
                                string[] nombrefile;
                                <div class="card-panel">
                                    <h5>Documentos de Soporte @ViewBag.relacionadan</h5>
                                    <div class="row" style="margin-bottom:0">
                                        @*@using (Html.BeginForm("Descargar", "Solicitudes", FormMethod.Post))
                                            {*@
                                        @try
                                        {
                                            foreach (TAT001.Models.Soporte item in ViewBag.soportes)
                                            {
                                                bool tiene = false;
                                                for (int i = 0; i < archivo.Count; i++)
                                                {
                                                    if (item.TSOPORTE_ID == archivo[i].CLASE & archivo[i].ACTIVO)
                                                    {
                                                        nombrefile = archivo[i].PATH.Split('\\');
                                                        tiene = true;
                                                        <div class="" id="desc-@item.TSOPORTE_ID">
                                                            <div class="col s11">
                                                                <div class="col s12">@item.TXT50</div>
                                                                <div class="file-field input-field">
                                                                    <input type="hidden" id="desc-@i" value="@archivo[i].PATH" />
                                                                    <a id="lbl_cargara-@i" name="archivo" class="btn-small" style="float:left;" @*type="submit"*@ value="@archivo[i].PATH" onclick="descargar(this.id)">DESCARGAR</a>
                                                                    <div class="file-path-wrapper">
                                                                        <input disabled value="@nombrefile[nombrefile.Length - 1]" id="disabled" type="text" class="file-path ">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col s1" style="padding-top:19px;">
                                                                <a href="#" class="red-text" id="elim-@item.TSOPORTE_ID" onclick="borraDescarga(this.id)">
                                                                    <i class="material-icons prefix">clear</i>
                                                                </a>
                                                            </div>
                                                        </div>
                                                        <div class="col s11 hidden" id="sube-@item.TSOPORTE_ID">
                                                            <div class="col s12">
                                                                @item.TXT50
                                                                @if (item.OBLIGATORIO)
                                                                {
                                                                    <span>*</span>
                                                                }
                                                            </div>
                                                            <input type="text" value="@item.TXT50" name="labels_soporte" hidden />
                                                            <div class="file-field input-field">
                                                                <div class="btn-small" style="float:left;">
                                                                    <span>Examinar</span>
                                                                    @if (item.OBLIGATORIO)
                                                                    {
                                                                        <input class="file_soporte ne" name="files_soporte" id="file_@item.TSOPORTE_ID" type="file" onchange="changeFile(this)">
                                                                    }
                                                                    else
                                                                    {
                                                                        <input class="file_soporte" name="files_soporte" id="file_@item.TSOPORTE_ID" type="file" onchange="changeFile(this)">
                                                                    }
                                                                </div>
                                                                <div class="file-path-wrapper">
                                                                    <input class="file-path " type="text">
                                                                </div>
                                                            </div>
                                                        </div>
                                                    }
                                                }
                                                if (!tiene)
                                                {
                                                    <div class="col s11">
                                                        <div class="col s12">
                                                            @item.TXT50
                                                            @if (item.OBLIGATORIO)
                                                            {
                                                                <span>*</span>
                                                            }
                                                        </div>
                                                        <input type="text" value="@item.TXT50" name="labels_soporte" hidden />
                                                        <div class="file-field input-field">
                                                            <div class="btn-small" style="float:left;">
                                                                <span>Examinar</span>
                                                                @if (item.OBLIGATORIO)
                                                                {
                                                                    <input class="file_soporte nec" name="files_soporte" id="file_@item.TSOPORTE_ID" type="file" onchange="changeFile(this)">
                                                                }
                                                                else
                                                                {
                                                                    <input class="file_soporte" name="files_soporte" id="file_@item.TSOPORTE_ID" type="file" onchange="changeFile(this)">
                                                                }
                                                            </div>
                                                            <div class="file-path-wrapper">
                                                                <input class="file-path " type="text">
                                                            </div>
                                                        </div>
                                                    </div>
                                                }
                                            }
                                        }
                                        catch (Exception e)
                                        {
                                        }
                                        @*}*@
                                    </div>
                                </div>
                            }
                        }
                    </div>
                    <div class="col s12 m6 l6">
                        @*@if (ViewBag.reversan != "X")
                            {
                                <div class="card-panel">
                                    <h5>Notas</h5>
                                    <div class="row" style="margin-bottom:0">
                                        <div class="row">
                                            <div class="input-field col s12">
                                                <textarea id="notas_soporte" name="notas_soporte" class="materialize-textarea" onkeyup="maxchar_notas();">@ViewBag.notas_soporte</textarea>
                                                <label for="notas_soporte"></label>
                                            </div>
                                        </div>
                                        <script>
                                            function maxchar_notas() {
                                                var maxLength = 500;
                                                var text = $('#notas_soporte').val();
                                                var textLength = text.length;
                                                if (textLength > (maxLength)) {
                                                    $('#notas_soporte').val(text.substring(0, ((maxLength))));
                                                    var msg = 'Número máximo para la nota es ' + maxLength;
                                                    M.toast({ html: msg });
                                                }
                                            }
                                        </script>
                                    </div>
                                </div>
                            }*@
                        @if (ViewBag.reversan == "X")
                        {
                            <input type="hidden" id="txt_rev" name="txt_rev" value="@ViewBag.reversa" disabled="disabled" />
                            <div class="card-panel">
                                <h5>Soporte de reverso</h5>
                                <div class="row" style="margin-bottom:0">
                                    <div class="col s12">
                                        <label name="labels_soporte2" hidden>Carta</label><label class="lbl_nec" hidden></label>
                                        <input type="text" value="Reversa" name="Sop" hidden />
                                        <div class="file-field input-field">
                                            <div class="btn-small" style="float:left;">
                                                <span>Examinar</span>
                                                <input class="file_soporte" name="files_soporte" id="file_rev" type="file">
                                            </div>
                                            <div class="file-path-wrapper">
                                                <input class="file-path " type="text">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="input-field col s12">
                                        <i class="material-icons prefix">date_range</i>
                                        @Html.Hidden("FECHAD_REV")
                                        <input value="@ViewBag.FECHAD_REV" id="fechad" type="text" class="" disabled="disabled" />
                                        <label for="fechad">Fecha</label>
                                    </div>
                                    <div class="row">
                                        <div class="input-field col s12">
                                            <textarea id="notas_soporte" name="notas_soporte" class="materialize-textarea" onkeyup="maxchar_notas();">@ViewBag.notas_soporte</textarea>
                                            <label for="notas_soporte">Razón del reverso</label>
                                        </div>
                                    </div>
                                    <script>
                                                                                function maxchar_notas() {
                                                                                    var maxLength = 500;
                                                                                    var text = $('#notas_soporte').val();
                                                                                    var textLength = text.length;
                                                                                    if (textLength > (maxLength)) {
                                                                                        $('#notas_soporte').val(text.substring(0, ((maxLength))));
                                                                                        var msg = 'Número máximo para la nota es ' + maxLength;
                                                                                        M.toast({ html: msg });
                                                                                    }
                                                                                }
                                    </script>
                                    <div class="form-group col s12">
                                        @Html.Label("TREVERSA", "Tipo de reverso", htmlAttributes: new { @class = "control-label col-md-2" })
                                        <div class="col-md-10">
                                            @Html.DropDownList("TREVERSA", null, "", htmlAttributes: new { @id = "treversa_id", @class = "form-control", onchange = @"selectTsolr(this.value)" })
                                        </div>
                                    </div>
                                    @*<a id="btn_guardarr" class="btn waves-effect waves-light btn-small disabled">Enviar</a>*@
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
            @*Distribución*@
            <div id="Distribucion_cont">
                <div class="row">
                    <div class="col s12 m6 l6">
                        <div class="card-panel">
                            @*<a class="btn" id="btn_getmat"><i class="material-icons left">add</i>GetMatServer</a>*@
                            <input type="text" id="catmat" name="catmat" value="@ViewBag.CATMAT" hidden />
                            <h5>Distribución</h5>
                            <div class="row" style="margin-bottom:0">
                                <div class="col s12">
                                    <label>
                                        @if (Model.DOCUMENTO_REF == null)
                                        {
                                            if (_ligada == true)//LEJ 23.07.2018
                                            {
                                                <input checked type="checkbox" name="chk_ligada" id="chk_ligada" onchange="cambiaLigada(this);" />
                                            }
                                            else
                                            {
                                                <input type="checkbox" name="chk_ligada" id="chk_ligada" onchange="cambiaLigada(this);" />
                                            }
                                        }
                                        else
                                        {
                                            if (_ligada == true)//LEJ 23.07.2018
                                            {
                                                <input checked type="checkbox" name="chk_ligada" id="chk_ligada" onchange="cambiaLigada(this);" disabled="disabled" />
                                            }
                                            else
                                            {
                                                <input type="checkbox" name="chk_ligada" id="chk_ligada" onchange="cambiaLigada(this);" disabled="disabled" />
                                            }
                                        }
                                        <span>Solicitud ligada a facturación </span>
                                    </label>


                                    @if (Model.DOCUMENTO_REF == null)
                                    {
                                        <script>
                                                                                        function cambiaLigada(campo) {
                                                                                            if (campo.checked) {
                                                                                                $("#select_neg").val("P");
                                                                                                $("#select_dis").val("C");
                                                                                                $("#select_negi").val("P");
                                                                                                $("#select_disi").val("C");
                                                                                                $("#select_neg").prop("disabled", "disabled");
                                                                                                $("#select_dis").prop("disabled", "disabled");
                                                                                                $("#select_neg").change();
                                                                                                $("#select_dis").change();
                                                                                                $("#div_objq").removeClass("hide");
                                                                                                $("#txt_ligada").val("X");
                                                                                            } else {
                                                                                                $("#select_neg").prop("disabled", false);
                                                                                                $("#select_dis").prop("disabled", false);
                                                                                                $("#select_neg").change();
                                                                                                $("#select_dis").change();
                                                                                                $("#div_objq").addClass("hide");
                                                                                                $("#txt_ligada").val("");
                                                                                            }
                                                                                        }
                                                                                        var elem = document.getElementById('select_neg');
                                                                                        var instance = M.FormSelect.init(elem, []);
                                                                                        elem = document.getElementById('select_dis');
                                                                                        instance = M.FormSelect.init(elem, []);
                                        </script>
                                    }
                                    else
                                    {
                                        <script>
                                                                                        function cambiaLigada(campo) {
                                                                                            if (campo.checked) {
                                                                                                $("#select_neg").val("P");
                                                                                                $("#select_dis").val("C");
                                                                                                $("#select_negi").val("P");
                                                                                                $("#select_disi").val("C");
                                                                                                $("#div_objq").removeClass("hide");
                                                                                                $("#txt_ligada").val("X");
                                                                                            } else {
                                                                                                $("#div_objq").addClass("hide");
                                                                                                $("#txt_ligada").val("");
                                                                                            }
                                                                                        }
                                        </script>
                                    }
                                </div>
                                @*<input type="button" id="matcat" value="Get materiales cat" />*@
                                <input type="text" id="select_negi" name="select_negi" value="@ViewBag.SEL_NEG" disabled="disabled" hidden />
                                <input type="text" id="select_disi" name="select_disi" value="@ViewBag.SEL_DIS" disabled="disabled" hidden />

                                <div class="input-field col s6">
                                    <select id="select_neg" name="select_neg" onchange="selectDis(this.value)" disabled>
                                        <option value="M">Monto</option>
                                        <option value="P">Porcentaje</option>
                                    </select>
                                    <label>Tipo de negociación</label>
                                </div>
                                <div class="input-field col s6">
                                    <select id="select_dis" name="select_dis" onchange="selectMonto(this.value,'X')">
                                        <option value="M">Material</option>
                                        <option value="C">Categoría</option>
                                    </select>
                                    <label>Distribución</label>
                                </div>
                                <div id="div_categoria" class="form-group col s6 div_categoria" style="display:none">
                                    @Html.LabelFor(model => model.TSOL_ID, "Categoría", htmlAttributes: new { @class = "control-label col-md-2" })
                                    <div class="col-md-10">
                                        @Html.DropDownList("CATEGORIA_ID", null, htmlAttributes: new { @id = "select_categoria", @class = "form-control" })
                                    </div>
                                </div>
                                @if (Model.DOCUMENTO_REF != null)
                                {
                                    <script>
                                                                                $("#select_neg").prop("disabled", "disabled");
                                                                                $("#select_dis").prop("disabled", "disabled");
                                                                                //$("#select_dis").change();

                                                                                var elem = document.getElementById('select_neg');
                                                                                var instance = M.FormSelect.init(elem, []);
                                                                                elem = document.getElementById('select_dis');
                                                                                instance = M.FormSelect.init(elem, []);
                                    </script>
                                }
                            </div>
                        </div>
                    </div>
                    <div id="div_montobase" class="col s12 m6 l6" style="display:none">
                        <div class="card-panel">
                            <h5>Monto Base</h5>
                            <div class="row" style="margin-bottom:0">
                                <div class="input-field col s6">
                                    <input value="@ViewBag.MONTO_DIS" id="monto_dis" type="text" class=" @ViewBag.reversa" />
                                    <label for="monto_dis">Monto</label>
                                </div>
                                <div class="input-field col s6">
                                    @*<div class="form-group">*@
                                    @*<div class="col-md-10">*@
                                    <input type="text" id="moneda_dis" name="monedadis" value="@ViewBag.moneda_dis" disabled="disabled" hidden /> @*//B20180625 MGC 2018.06.28*@
                                    @if (Model.DOCUMENTO_REF == null)
                                    {
                                        @Html.DropDownList("MONEDA", null, htmlAttributes: new { @id = "monedadis_id", @class = "form-control" })
                                    }
                                    else
                                    {
                                        @Html.DropDownList("MONEDA", null, htmlAttributes: new { @id = "monedadis_id", @class = "form-control", @disabled = "disabled" })
                                    }
                                    @Html.LabelFor(model => model.MONEDA_ID, "Moneda", htmlAttributes: new { @for = "monedadis_id" })
                                    @*</div>
                                        </div>*@
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="div_apoyobase" class="col s12 m6 l6" style="display:none">
                        <div class="card-panel">
                            <h5>Base para aplicar %</h5>
                            <div class="row" style="margin-bottom:0">
                                <div class="input-field col s6">
                                    <input value="@ViewBag.BMONTO_APOYO" id="bmonto_apoyo" type="text" class="" name="bmonto_apoyo" />
                                    <label for="bmonto_apoyo">% Apoyo</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col s12">
                        <div class="card-panel">
                            <h5>Mecánica de Negociación</h5>
                            <div class="row" style="margin-bottom:0;overflow-x:auto;">
                                @*@if (ViewBag.relacionadan == "")*@
                                @if (ViewBag.relacionadan != "" & ViewBag.reversan != "X" & (Model.DOCUMENTO_REF == null | Model.TSOL.ADICIONA))
                                {
                                    <div class="file-field input-field" id="cargar_excel" style="display:none">
                                        <div class="btn">
                                            <span>Examinar</span>
                                            <input id="file_dis" type="file">
                                        </div>
                                        <div class="file-path-wrapper">
                                            <input class="file-path " type="text">
                                        </div>
                                    </div>
                                    <div id="div_btns_row" style="display:none">
                                        <a class="btn" id="addRow"><i class="material-icons left">add</i>Registro</a>
                                        <a class="btn" id="delRow"><i class="material-icons left">clear</i>Registro</a>
                                    </div>
                                }
                                <div id="div_picker"></div>
                                <table id="table_dis" class="display" cellspacing="0" width="100%" style="display:none">
                                    <thead>
                                        <tr>
                                            <th></th> @*ID*@
                                            <th></th> @*Detalle*@
                                            <th></th> @*Seleccionar*@
                                            <th>Vigencia De</th>
                                            <th>Vigencia Al</th>
                                            <th>Material</th>
                                            <th>Categoría</th>
                                            <th>Descripción</th>
                                            <th>Costo unitario</th>
                                            <th>% Apoyo</th>
                                            <th>Apoyo por pieza</th>
                                            <th>Costo con apoyo</th>
                                            <th>Precio sugerido</th>
                                            <th id="lbl_volumen">Volumen estimado</th>
                                            @*<th id="lbl_apoyoee">Estimado apoyo</th>*@<!--RSG 05.06.2018-->
                                            <th id="lbl_apoyo">Estimado apoyo</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                    <tfoot id="tfoot_dis" style="">
                                        @*//display:none*@
                                        <tr>
                                            @*<th colspan="14" style="text-align:right">Total:</th>*@<!--RSG 05.06.2018-->
                                            <th colspan="14" style="text-align:right">Total:</th>
                                            <th id="total_dis"></th>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>
                        @*Tabla para ser enviada siempre está oculta*@
                        <table id="table_dish" class="display" cellspacing="0" width="100%" style="display:none">
                            @*
                                <thead>
                                    <tr>
                                        <th>Pos</th>
                                        <th>Vigencia De</th>
                                        <th>Vigencia Al</th>
                                        <th>Material</th>
                                        <th>Categoría</th>
                                        <th>Categoría ID</th>
                                        <th>Costo unitario</th>
                                        <th>% Apoyo</th>
                                        <th>Apoyo por pieza</th>
                                        <th>Precio sugerido</th>
                                        <th>Volumen estimado</th>
                                        <th>Volumen real</th>
                                        <th>Apoyo estimado</th>
                                        <th>Apoyo real</th>
                                    </tr>
                                </thead>*@
                            <tbody>
                                @if (Model.DOCUMENTOP != null)
                                {
                                    for (var i = 0; i < Model.DOCUMENTOP.Count; i++)
                                    {
                                        <tr>
                                            <td>
                                                @Html.EditorFor(m => m.DOCUMENTOP[i].POS)
                                            </td>
                                            <td>
                                                @Html.EditorFor(m => m.DOCUMENTOP[i].VIGENCIA_DE)
                                            </td>
                                            <td>
                                                @Html.EditorFor(m => m.DOCUMENTOP[i].VIGENCIA_AL)
                                            </td>
                                            <td>
                                                @Html.EditorFor(m => m.DOCUMENTOP[i].MATNR)
                                            </td>
                                            <td>
                                                @Html.EditorFor(m => m.DOCUMENTOP[i].MATKL)
                                            </td>
                                            <td>
                                                @Html.EditorFor(m => m.DOCUMENTOP[i].MATKL_ID)
                                            </td>
                                            <td>
                                                @Html.EditorFor(m => m.DOCUMENTOP[i].MONTO)
                                            </td>
                                            <td>
                                                @Html.EditorFor(m => m.DOCUMENTOP[i].PORC_APOYO)
                                            </td>
                                            <td>
                                                @Html.EditorFor(m => m.DOCUMENTOP[i].MONTO_APOYO)
                                            </td>
                                            <td>
                                                @Html.EditorFor(m => m.DOCUMENTOP[i].PRECIO_SUG)
                                            </td>
                                            <td>
                                                @Html.EditorFor(m => m.DOCUMENTOP[i].VOLUMEN_EST)
                                            </td>
                                            <td>
                                                @Html.EditorFor(m => m.DOCUMENTOP[i].VOLUMEN_REAL)
                                            </td>
                                            <td>
                                                @Html.EditorFor(m => m.DOCUMENTOP[i].APOYO_EST)
                                            </td>
                                            <td>
                                                @Html.EditorFor(m => m.DOCUMENTOP[i].APOYO_REAL)
                                            </td>
                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>
                        @*Tabla para ser enviada siempre está oculta*@
                    </div>
                </div>
            </div>
            @*Financiera*@
            <div id="Financiera_cont">
                <div class="row">
                    <div class="col s12 m6 l6">
                        <div class="card-panel">
                            <div class="row" style="margin-bottom:0">
                                <div class="row">
                                    <div class="input-field col s6">
                                        <input value="" id="monto_doc_md" type="text" class="" disabled="disabled" />
                                        <label for="monto_doc_md">Monto</label>
                                        @Html.HiddenFor(model => model.MONTO_DOC_MD)
                                    </div>
                                    <div class="input-field col s6">
                                        @*<div class="form-group">*@
                                        @*<div class="col-md-10">*@
                                        @Html.DropDownList("MONEDA", null, htmlAttributes: new { @id = "moneda_id", @class = "form-control " + @ViewBag.relacionada, onchange = @"selectMoneda(this.value)" })
                                        @Html.LabelFor(model => model.MONEDA_ID, "Moneda", htmlAttributes: new { @for = "moneda_id" })
                                        @*</div>
                                            </div>*@
                                    </div>
                                    <div class="form-group">
                                        <div class="col-md-10">
                                            @Html.EditorFor(model => model.MONEDA_ID, new { htmlAttributes = new { @id = "monedas_id", @class = "form-control", @style = "display: none" } })   @*@style = "display: none"*@
                                        </div>
                                    </div>
                                    <div class="form-group input-field col s6">
                                        @Html.LabelFor(model => model.TIPO_CAMBIO, "Tipo de cambio", htmlAttributes: new { @class = "control-label active" })
                                        <div class="col-md-10">
                                            @*@Html.EditorFor(model => model.TIPO_CAMBIO, new { htmlAttributes = new { @id = "tipo_cambio", @class = "form-control " + @ViewBag.relacionada, @Value = ViewBag.tcambio } })*@
                                            @*@Html.EditorFor(model => model.TIPO_CAMBIO, new { htmlAttributes = new { @id = "tipo_cambio", @class = "form-control " + @ViewBag.relacionada } })*@
                                            <input type="text" disabled="disabled" id="tipo_cambio" value="@Model.TIPO_CAMBIO" />
                                        </div>
                                    </div>
                                    <script>
                                                                                var aa = $("#tipo_cambio").val();
                                    </script>
                                    <div class=" input-field col s6">
                                        <input value="" id="montos_doc_ml2" type="text" class="" disabled="disabled" />
                                        <label for="montos_doc_ml2">Monto en USD</label>
                                    </div>
                                    <div class="form-group">
                                        @Html.LabelFor(model => model.MONTO_DOC_ML, htmlAttributes: new { @class = "control-label col-md-2", @style = "display: none" })
                                        <div class="col-md-10">
                                            @Html.EditorFor(model => model.MONTO_DOC_ML, new { htmlAttributes = new { @class = "form-control", @style = "display: none" } })
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        @Html.LabelFor(model => model.MONTO_DOC_ML2, htmlAttributes: new { @class = "control-label col-md-2", @style = "display: none" })
                                        <div class="col-md-10">
                                            @Html.EditorFor(model => model.MONTO_DOC_ML2, new { htmlAttributes = new { @id = "monto_doc_ml2", @class = "form-control", @style = "display: none" } })
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card-panel">
                            <h5 id="head_analisispre">Análisis Presupuesto</h5>@*B20180801 MGC Textos*@
                            <p style="font-size:15px">Última fecha de carga @ViewBag.ultMod</p>
                            <div class="row" style="margin-bottom:0">
                                <ul class="collection">
                                    <li class="collection-item">
                                        <div class="row" style="margin-bottom:0">
                                            <div class="col s3">
                                                <div id="lbl_presupuestocanal">Presupuesto canal</div>@*B20180801 MGC Textos*@
                                            </div>
                                            <dic class="col s6">
                                                <b id="p_vtweg"></b>
                                            </dic>
                                            <div class="col s3 right-align">
                                                <b id="p_canal"></b>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="collection-item">
                                        <div class="row" style="margin-bottom:0">
                                            <div class="col s3">
                                                <div id="lbl_presupuestocliente">Presupuesto cliente</div>@*B20180801 MGC Textos*@
                                            </div>
                                            <div class="col s6">
                                                <b id="p_kunnr"></b>
                                            </div>
                                            <div class="col s3 right-align">
                                                <b id="p_banner"></b>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                            <div class="row" style="margin-bottom:0">
                                <ul class="collection">
                                    <li class="collection-item">
                                        <div class="row" style="margin-bottom:0;">
                                            <div class="col s6">
                                                <div id="lbl_regsap">Registrado en SAP</div>
                                            </div>
                                            <div class="col s3 right-align">
                                                <div id="pc_c"></div>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="collection-item">
                                        <div class="row" style="margin-bottom:0;">
                                            <div class="col s6">
                                                <div id="lbl_regsapp">Por registrar en SAP</div>@*B20180801 MGC Textos*@
                                            </div>
                                            <div class="col s3 right-align">
                                                <div id="pc_a"></div>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="collection-item">
                                        <div class="row" style="margin-bottom:0;">
                                            <div class="col s6">
                                                <div id="lbl_procesotat">En proceso TAT</div>@*B20180801 MGC Textos*@
                                            </div>
                                            <div class="col s3 right-align">
                                                <u id="pc_p"></u>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="collection-item">
                                        <div class="row" style="margin-bottom:0;">
                                            <div class="col s6">
                                                <div id="lbl_consumido">Consumido</div>@*B20180801 MGC Textos*@
                                            </div>
                                            <div class="col s6 right-align">
                                                <u><b id="pc_t"></b></u>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="collection-item">
                                        <div class="row" style="margin-bottom:0;">
                                            <div class="col s6">
                                                <div id="lbl_presudisponible">Presupuesto disponible</div>@*B20180801 MGC Textos*@
                                            </div>
                                            <div class="col s6 right-align">
                                                <b id="consu"></b>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div>
                        <div class="col s12 m6 l6">
                            <!--RSG 22.05.2018-->
                            <div class="card-panel">
                                <div class="row">
                                    <h5>Cuentas</h5>
                                    <div class="col s12">
                                        <div id="div_clearing">
                                        </div>
                                    </div>
                                </div>
                                <script>
                            var clearing = [];
                            function getClearing(gall) {
                                $("#div_clearing").empty();
                                clearing = [];
                                /**/
                                /**/
                                var bukrs = '@Model.SOCIEDAD_ID';
                            /**/
                            /**/
                            /**/
                            /**/
                            var land = '@Model.PAIS_ID';
                            /**/
                            /**/
                            /**/
                            /**/
                            var ejercicio = '@Model.EJERCICIO';
                            /**/
                            /**/
                            $.ajax({
                                type: "POST",
                                url: '../Listas/clearing',
                                dataType: "json",
                                data: { bukrs: bukrs, land: land, gall: gall, ejercicio: ejercicio },

                                success: function (data) {
                                    if (data !== null || data !== "") {
                                        //RSG 26.04.2018----------------
                                        clearing.push(data.ABONO);
                                        clearing.push(data.CARGO);
                                        clearing.push(data.CLEARING);
                                        clearing.push(data.LIMITE);
                                        //RSG 26.04.2018----------------
                                    }

                                },
                                error: function (xhr, httpStatusMessage, customErrorMessage) {
                                    //M.toast({ html: httpStatusMessage });
                                },
                                async: false
                            });

                        }
                        function formaClearing() {
                            getClearing(document.getElementById("tall_id").value);
                            $("#div_clearing").empty();
                                //var monto = document.getElementById("monto_dis").value;
                                var monto = $('#monto_doc_md').val();
                            var div = "<ul class='collection'><li class='collection-item'>";
                            div += "<div class='row' style='margin-bottom:0;'><div class='col s4'>Abono</div><div class='col s4'>" + clearing[0] + "</div><div class='col s4'>" + monto + "</div></div>";
                            div += "</li><li class='collection-item'>";

                            if (clearing[3] == null) {
                                div += "<div class='row' style='margin-bottom:0;'><div class='col s4'>Cargo</div><div class='col s4'>" + clearing[1] + "</div><div class='col s4'>" + monto + "</div></div>";
                            } else {
                                if (clearing[2] != null) {
                                    if (monto <= clearing[3]) {
                                        div += "<div class='row' style='margin-bottom:0;'><div class='col s4'>Cargo</div><div class='col s4'>" + clearing[1] + "</div><div class='col s4'>" + monto + "</div></div>";
                                        div += "</li><li class='collection-item'>";
                                        div += "<div class='row' style='margin-bottom:0;'><div class='col s4'>Clearing</div><div class='col s4'>" + clearing[2] + "</div><div class='col s4'>0.00</div></div>";
                                        div += "</li>";
                                    } else {
                                        div += "<div class='row' style='margin-bottom:0;'><div class='col s4'>Cargo</div><div class='col s4'>" + clearing[1] + "</div><div class='col s4'>" + clearing[3] + "</div></div>";
                                        div += "</li><li class='collection-item'>";
                                        div += "<div class='row' style='margin-bottom:0;'><div class='col s4'>Clearing</div><div class='col s4'>" + clearing[2] + "</div><div class='col s4'>" + (monto - clearing[3]) + "</div></div>";
                                        div += "</li>";
                                    }
                                }
                            }
                            div += "</li>";
                            div += "</ul>";
                            $("#div_clearing").append(div);
                        }
                                </script>
                            </div>
                            <div class="card-panel" style="display:none;">
                                <h5>Análisis Solicitud</h5>
                                <div class="row" style="margin-bottom:0">
                                    <div class="col s12">
                                        <ul class="collection">
                                            <li class="collection-item">
                                                <div class="row" style="margin-bottom:0;padding-bottom:0;">
                                                    <div class="col s6">
                                                        Importe solicitud
                                                    </div>
                                                    <div class="col s6 right-align">
                                                        <span id="s_montob">-</span>
                                                    </div>
                                                </div>
                                            </li>
                                            <li class="collection-item">
                                                <div class="row" style="margin-bottom:0;padding-bottom:0;">
                                                    <div class="col s6">
                                                        Monto provisión original
                                                    </div>
                                                    <div class="col s6 right-align">
                                                        <span id="s_montop">-</span>
                                                    </div>
                                                </div>
                                            </li>
                                            <li class="collection-item">
                                                <div class="row" style="margin-bottom:0;padding-bottom:0;">
                                                    <div class="col s6">
                                                        Monto aplicado
                                                    </div>
                                                    <div class="col s6 right-align">
                                                        <span id="s_montoa">-</span>
                                                    </div>
                                                </div>
                                            </li>
                                            <li class="collection-item" id="a4">
                                                <div class="row" style="margin-bottom:0;padding-bottom:0;">
                                                    <div class="col s6">
                                                        Remanente/(Exceso)
                                                    </div>
                                                    <div class="col s6 right-align">
                                                        <span id="s_rema">-</span>
                                                    </div>
                                                </div>
                                            </li>
                                            <li class="collection-item" id="a5">
                                                <div class="row" style="margin-bottom:0;padding-bottom:0;">
                                                    <div class="col s6">
                                                        Monto total
                                                    </div>
                                                    <div class="col s6 right-align">
                                                        <span id="s_total">-</span>
                                                    </div>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            @*<div class="card-panel">
                                    <h5>Análisis Solicitud</h5>
                                    <div class="row" style="margin-bottom:0">
                                        <table class="tg">
                                            <tr>
                                                <td class="tg-yw4l">
                                                    <label>Importe solicitud</label>
                                                </td>
                                                <td class="tg-yw4l">
                                                    <label id=""></label>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="tg-yw4l">
                                                    <label>Monto provisión original</label>
                                                </td>
                                                <td class="tg-yw4l">
                                                    <label id=""></label>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="tg-yw4l">
                                                    <label>Monto aplicado</label>
                                                </td>
                                                <td class="tg-yw4l">
                                                    <label id=""></label>
                                                </td>
                                            </tr>
                                            <tr id="s_color">
                                                <td class="tg-yw4l">
                                                    <label id="">Remanente/(Exceso)</label>
                                                </td>
                                                <td class="tg-yw4l">
                                                    <label id=""></label>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="tg-yw4l">
                                                    <label>Impuesto a</label>
                                                </td>
                                                <td class="tg-yw4l">
                                                    <label id="s_impa"></label>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="tg-yw4l">
                                                    <label>Impuesto b</label>
                                                </td>
                                                <td class="tg-yw4l">
                                                    <label id="s_impb"></label>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="tg-yw4l">
                                                    <label>Impuesto c</label>
                                                </td>
                                                <td class="tg-yw4l">
                                                    <label id="s_impc"></label>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="tg-yw4l">
                                                    <label>Retención</label>
                                                </td>
                                                <td class="tg-yw4l">
                                                    <label id="s_ret"></label>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="tg-yw4l">
                                                    <label>Monto total</label>
                                                </td>
                                                <td class="tg-yw4l">
                                                    <label id=""></label>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>*@
                        </div>
                    </div>
                </div>
            </div>
            @* SCRIPT ------------------------------------------------------------------------------------------ LEJ 09.07.18*@
            <script src="~/Scripts/ValidarFormatoDecimalesC.js"></script>
            <div class="form-group">
                <div class="col-md-offset-2 col-md-10">
                    <input style="display:none" id="btn_guardar" type="submit" value="Guardar" class="btn btn-default" />
                </div>
            </div>
        </div>

    }
</div>
@if (ViewBag.workflow.Count != 0)
{
    <div class="row" style="font-size:12px;">
        <div class="col s12">
            <div class="row" style="margin-bottom:0">
                <div class="card-panel">
                    <h5>Workflow</h5>
                    @*
                        <script src="//code.jquery.com/jquery-1.12.4.js"></script>
                        <script src="//cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
                        <script src="//cdn.datatables.net/1.10.16/js/dataTables.material.min.js"></script>
                        <link href="~/Content/dataTable.css" rel="stylesheet" />
                        <link href="//cdn.datatables.net/1.10.16/css/dataTables.material.min.css" rel="stylesheet" />*@
                    <table class="table highlight responsive-table" id="table">
                        <thead>
                            <tr>
                                <th width="">
                                    Usuario
                                </th>
                                <th width="">
                                    Evento
                                </th>
                                <th width=""> Fecha inicio</th>
                                <th width=""> Hora inicio</th>
                                <th width=""> Fecha término</th>
                                <th width=""> Hora término</th>
                                <th width="">
                                    Estatus
                                </th>
                                <th width="30%">
                                    Comentario
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (TAT001.Entities.FLUJO f in ViewBag.workflow)
                            {
                                <tr>
                                    <td width=""> @Html.DisplayFor(modelItem => f.USUARIOA_ID) - @Html.DisplayFor(modelItem => f.USUARIO.NOMBRE) @Html.DisplayFor(modelItem => f.USUARIO.APELLIDO_P) @Html.DisplayFor(modelItem => f.USUARIO.APELLIDO_M) </td>
                                    <td width=""> @Html.DisplayFor(modelItem => f.WORKFP.ACCION.DESCCRIPCION) </td>
                                    <td width=""> @f.FECHAC.Value.ToShortDateString() </td>
                                    <td width=""> @f.FECHAC.Value.TimeOfDay.ToString().Split('.')[0] </td>
                                    <td width=""> @f.FECHAM.Value.ToShortDateString() </td>
                                    <td width=""> @f.FECHAM.Value.TimeOfDay.ToString().Split('.')[0] </td>
                                    <td width=""> @Html.DisplayFor(modelItem => f.ESTATUS) </td>
                                    <td width="30%"> @Html.DisplayFor(modelItem => f.COMENTARIO) </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

}

@*@if (ViewBag.original == null)
    {
        <script>
            function analisis() {

                var num2 = $('#monto_doc_md').val();//RSG 12.06.2018
                var monto = document.getElementById("monto_dis").value;//RSG 12.06.2018
                document.getElementById("analisis1").innerHTML = "$" + monto;
                document.getElementById("analisis4").innerHTML = "$" + monto;
                document.getElementById("analisis5").innerHTML = "$" + monto;
            }
        </script>
    }
    else
    {
        <script>
            function analisis() {

                var num2 = $('#monto_doc_md').val();//RSG 12.06.2018
                var monto = document.getElementById("monto_dis").value;
                var original = @ViewBag.original;
                var aplicado = @ViewBag.sumaRel;
                document.getElementById("analisis1").innerHTML = "$" + (monto);
                document.getElementById("analisis2").innerHTML = "$" + (original);
                document.getElementById("analisis3").innerHTML = "$" + (aplicado);
                document.getElementById("analisis4").innerHTML = "$" + (original - aplicado- monto);
                document.getElementById("analisis5").innerHTML = "$" + (monto);
                if ((original - aplicado - monto) < 0) {
                    document.getElementById("a4").classList.add("red");
                    document.getElementById("a4").classList.add("white-text");
                }
            }
        </script>
    }*@
@{
    List<TAT001.Entities.DOCUMENTOA> archivos = ViewBag.files as List<TAT001.Entities.DOCUMENTOA>;
    if (ViewBag.relacionadan != "" && archivos.Count > 0)
    {
        string[] nombrefile;
        <div class="card-panel" style="display:none">
            <h5>Documentos de Soporte @ViewBag.relacionadan</h5>
            <div class="row" style="margin-bottom:0">
                @using (Html.BeginForm("Descargar", "Solicitudes", FormMethod.Post))
                {
                    try
                    {
                        for (int i = 0; i < archivos.Count; i++)
                        {

                            nombrefile = archivos[i].PATH.Split('\\');
                            <div class="col s11">
                                <div class="file-field input-field">
                                    <input type="hidden" id="desc-@i" value="@archivos[i].PATH" />
                                    <button id="lbl_cargar-@i" name="archivo" class="btn-small" style="float:left;" type="submit" value="@archivos[i].PATH">DESCARGAR</button>
                                    <div class="file-path-wrapper">
                                        <input disabled value="@nombrefile[nombrefile.Length - 1]" id="disabled" type="text" class="file-path ">
                                    </div>
                                </div>
                            </div>
                            <div class="col s1" style="padding-top:19px;">
                                <a href="#" class="red-text">
                                    <i class="material-icons prefix">clear</i>
                                </a>
                            </div>
                        }
                    }
                    catch (Exception)
                    {
                    }
                }
            </div>
        </div>
    }
}

<div id="validaciones">
    <script>
            var lista1 = [];
            var lista = @Html.Raw(ViewBag.listaValid);
    </script>
    <script src="~/Scripts/warning.js"></script>
</div>